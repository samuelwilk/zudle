{# TODO: this is also used in _calendar.html.twig, would be nice to get rid of duplication #}
{% set dayClass = 'flex items-center w-16 h-16 justify-center font-bold rounded m-1' %}

{% if game.status == constant('App\\Enum\\GameStatusEnum::IN_PROGRESS') %}
    {% set color = 'bg-in-progress text-white' %}
{% elseif game.status == constant('App\\Enum\\GameStatusEnum::WON') %}
    {% set color = 'bg-won text-white' %}
{% elseif game.status == constant('App\\Enum\\GameStatusEnum::LOST') %}
    {% set color = 'bg-lost text-white' %}
{% endif %}

<a data-popover-target="popover-default-{{ game.id }}" type="button" href="{{ path('app_game_show', {id: game.id}) }}" class="{{ dayClass }} {{ color }} grow"></a>
<div data-popover id="popover-default-{{ game.id }}" role="tooltip" class="absolute z-10 invisible inline-block w-64 text-sm text-gray-500 transition-opacity duration-400 bg-zu-lighter-black border border-gray-200 rounded-lg shadow-sm opacity-0 dark:text-gray-400 dark:border-gray-600 dark:bg-zu-white">
    <div class="px-3 py-2 bg-gray-100 border-b border-gray-200 rounded-t-lg dark:border-gray-600 dark:bg-gray-700">
        <h3 class="font-semibold text-gray-900 dark:text-white">{{ game.createdAt|date("F d - H:i") }}</h3>
    </div>
    <div class="px-3 py-2 flex flex-col justify-between">
        <div class="m-2">
            {{ game.guesses|length }} of {{ game.maxAttempts }} attempts used
        </div>
        <div class="m-2">
            {% if game.status == constant('App\\Enum\\GameStatusEnum::IN_PROGRESS') %}
                {% set latestGuess = game.guesses|last %}

                {% if latestGuess %}
                    Latest Guess: {{ latestGuess.guess }}
                {% else %}
                    No guesses yet
                {% endif %}
            {% elseif game.status == constant('App\\Enum\\GameStatusEnum::WON') %}
                {% set winningGuess = game.guesses|last %}
                {# TODO: need to hydrate this somehow #}
                {{ winningGuess.getUser() }}
            {% elseif game.status == constant('App\\Enum\\GameStatusEnum::LOST') %}
                House Wins
            {% endif %}
        </div>
    </div>
    <div data-popper-arrow></div>
</div>
